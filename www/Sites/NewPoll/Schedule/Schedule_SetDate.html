<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <title>SetDate</title>
        <meta charset="UTF-8">
        <meta http-equiv="Content-Security-Policy" content="default-src 'self' data: gap: https://ssl.gstatic.com 'unsafe-eval'; style-src 'self' 'unsafe-inline'; media-src *">
        <meta name="format-detection" content="telephone=no">
        <meta name="msapplication-tap-highlight" content="no">
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width">

        <link href="../../../css/jquery.mobile-1.4.5.min.css" rel="stylesheet" type="text/css"/>
        <link rel="stylesheet" type="text/css" href="../../../css/style.css">


    </head>
    <body>   
        <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript" src="../../../js/index.js"></script>
        <script type="text/javascript" src="../../../js/jquery.min.js"></script>
        <script type="text/javascript" src="../../../js/jquery.mobile-1.4.5.min.js"></script>


        <div data-role="page">
            <div data-role="header">               
                <h1>Zeiten</h1>

            </div>


            <div data-role="main" class="ui-content" id="container" >
                <div id="container0">
                    <a data-role="button"  onclick="dateElementClicked(this)" id="anchor0">Neuen Termin Hinzufügen</a>
                </div>

            </div>

            <div data-role="footer"  data-position="fixed" >
                <a  href="Schedule_settings.html" data-transition="slide" data-direction="reverse" >Zur&uuml;ck</a>
                <a  href="Schedule_End.html" data-transition="slide" style="float: right" >Weiter</a>
            </div>
        </div > 

        <script>

            var numberOfAppointments = 0;
            /*var apointment = {
             id: 0,
             date: 0,
             rolled: false
             };*/
            var appointmentList = new Array();

            //$(document).ready(newDateElement());   
            /*Controls what happens if a dateElement is clicked:
             * 
             * if its the first time it will change to a normal dateElement
             * else it will be pop out an will be editable or shrink
             */
            function dateElementClicked(clickedAnchor) {
                //anchor is clicked the first time(the id number equals numberOfAppointments)
                if (clickedAnchor.id.slice(-1) == numberOfAppointments) {
                    dateElementClickedFirstTime(clickedAnchor);
                }
                else if (appointmentList[getDateElementNumber(clickedAnchor)]["RolledOut"] == true)
                {
                    hideContent(getDateElementNumber(clickedAnchor));
                }
                else if (appointmentList[getDateElementNumber(clickedAnchor)]["RolledOut"] == false)
                {
                    showContent(getDateElementNumber(clickedAnchor));
                }
                else
                {
                    alert("Element not listed");
                }
            }

            //gets the Number of the Dateelement of a clicked Anchor
            function getDateElementNumber(clickedAnchor) {
                return(clickedAnchor.id.slice(-1));
            }

            //Show and Hide

            //Hides in inputs and p of certain date Element
            function hideContent(elementNumber) {
                document.getElementById("content" + elementNumber).style.visibility = "hidden";
                document.getElementById("content" + elementNumber).style.height = "0px";
                appointmentList[elementNumber]["RolledOut"] = false;
            }
            //Shows in inputs and p of certain date Element
            function showContent(elementNumber) {
                document.getElementById("content" + elementNumber).style.visibility = "visible";
                document.getElementById("content" + elementNumber).style.height = "auto";
                appointmentList[elementNumber]["RolledOut"] = true;
            }




            // if a is clicked the first Time
            function dateElementClickedFirstTime(clickedAnchor) {
                //adding the html stuff

                //the container div which should get html stuff
                var divContainer = clickedAnchor.parentElement;

                /*div.attr("id", "dateElement" + numberOfAppointments);
                 div.appendTo("<p id='labelDate'>Datum: <input id='day' value=''/><input id='month' value='MM'/><input class='big' id='year' value='YYYY'/></p>");
                 div.appendTo("<p id='labelTime'>Uhrzeit: <input id='hour' value='hour'/><input id='min' value='min'/></p>");
                 div.css("background-color", "#009688");*/
                divContainer.style = "background-color:#009688; border-radius:16px; margin: 0px 2 px 0px 5px";
                divContainer.innerHTML = divContainer.innerHTML + 
                        "<div id='content"+ numberOfAppointments +"' style='padding: 3px 3px 3px 3px'><p id='labelDate' style='visibility:inherit'>Datum: <input class='.ui-input-text' id='day' value='' style='visibility:inherit'/><input id='month' value='MM' style='visibility:inherit'/><input id='year' value='YYYY' style='visibility:inherit'/></p><p id='labelTime' style='visibility:inherit'>Uhrzeit: <input id='hour' value='hour' style='visibility:inherit'/><input id='min' value='min' style='visibility:inherit'/></p></div>"



                //adding to apoinment list
                appointmentList[numberOfAppointments] = new Object();
                appointmentList[numberOfAppointments]["Id"] = numberOfAppointments;
                appointmentList[numberOfAppointments]["Date"] = new Date();
                appointmentList[numberOfAppointments]["RolledOut"] = true;

                //decide which Time and Date will be preconfigured
                var dateTime = appointmentList[numberOfAppointments]["Date"];
                /*
                 if (numberOfAppointments == 0) {
                 setCurrentTime(numberOfAppointments, dateTime);
                 }
                 
                 else if (numberOfAppointments == 0) {
                 dateTime.setHours(dateTime.getHours() + numberOfAppointments);
                 setCurrentTime(numberOfAppointments, dateTime);
                 }
                 */


                //countig up the ID counter (must come at last)
                numberOfAppointments += 1;
                newDateElement();
            }


            /*adds a new Date Element to the Container div*/
            function newDateElement() {
                //document.getElementsByClassName("ui-content").innerHTML = "<p>Hello</p>";
                var unrolledDiv = document.createElement("div");
                unrolledDiv.id = "container" + numberOfAppointments;
                unrolledDiv.innerHTML = "<a data-role='button' onclick='dateElementClicked(this)' class='ui-link ui-btn ui-shadow ui-corner-all' role='button' id='anchor" + numberOfAppointments + "'>Neuen Termin Hinzufügen</a>";
                //var text = document.createTextNode("new paragraph number: " );
                //newP.appendChild(text);
                document.getElementsByClassName("ui-content")[0].appendChild(unrolledDiv);
                //document.getElementById("container").appendChild(newP);
            }

        </script>

    </body>
</html>
